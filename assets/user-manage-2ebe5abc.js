import{g as N,b as $,u as z,d as B}from"./admin-3d7a5300.js";import{_ as p}from"./NormalButton.vue_vue_type_script_setup_true_lang-01525941.js";import{_ as D}from"./Pagination.vue_vue_type_script_setup_true_lang-0c199d3f.js";import{d as M,u as A,j as F,r as m,o as P,c as f,k as t,l as s,e as g,F as R,b as T,a as c,g as w,p as k,w as d,h,R as V,q as y}from"./index-c222d082.js";import{N as C}from"./nprogress-131c7954.js";const j=t("p",{class:"mb-4 text-2xl font-bold"},"用户管理",-1),q={class:"w-full table-fixed text-center"},I=t("colgroup",null,[t("col",{width:"10"}),t("col",{width:"10%"}),t("col",{width:"700"}),t("col",{width:"10%"}),t("col",{width:"10%"}),t("col",{width:"10%"}),t("col",{width:"10%"}),t("col",{width:"10%"}),t("col",{width:"30%"})],-1),G=t("tr",null,[t("th",null,"UID"),t("th",null,"用户名"),t("th",null,"昵称"),t("th",null,"邮箱"),t("th",null,"性别"),t("th",null,"用户组"),t("th",null,"状态"),t("th",null,"头像"),t("th",null,"操作")],-1),H={class:"whitespace-nowrap"},J={class:"whitespace-nowrap"},K={class:"whitespace-nowrap overflow-ellipsis"},tt=M({__name:"user-manage",setup(O){const u=A(),n=F(),_=m([]),r=m(1),i=m(0),x={0:"正常",2:"封禁"},b={MALE:"男",FEMALE:"男",SECRET:"保密"};P(()=>{l()});function l(){C.start(),_.value=[],N(u.token,r.value).then(a=>{_.value=a.users,i.value=a.count}).catch(a=>{n.error(a.message)}).finally(()=>{C.done()})}function E(a){window.open(a)}function U(a,o){o===0?$(u.token,a).then(e=>{n.success("封禁用户成功"),l()}).catch(e=>{n.error("封禁用户失败"+e.message)}):z(u.token,a).then(e=>{n.success("解禁用户成功"),l()}).catch(e=>{n.error("解禁用户失败："+e.message)})}function L(a){B(u.token,a).then(o=>{n.success("删除用户成功："),l()}).catch(o=>{n.error("解禁用户失败："+o.message)})}function S(a){r.value=a,l()}return(a,o)=>(w(),f("div",null,[j,t("p",null,"用户总数："+s(i.value),1),t("p",null,"当前页："+s(r.value)+" , 总页数："+s(Math.ceil(i.value/g(k))),1),t("table",q,[I,G,(w(!0),f(R,null,T(_.value,e=>(w(),f("tr",null,[t("td",null,[c(g(V),{to:"/user/"+e.uid},{default:d(()=>[h(s(e.uid),1)]),_:2},1032,["to"])]),t("td",H,s(e.name),1),t("td",J,s(e.nickname),1),t("td",null,s(e.email),1),t("td",null,s(b[e.sex]),1),t("td",null,s(e.role),1),t("td",{class:y(e.status===2?"text-red-500":"")},s(x[e.status]),3),t("td",K,[c(p,{onClick:v=>E(e.avatar)},{default:d(()=>[h("查看图片")]),_:2},1032,["onClick"])]),t("td",null,[c(p,{onClick:v=>U(e.uid,e.status)},{default:d(()=>[h(s(e.status===0?"封禁":"解禁"),1)]),_:2},1032,["onClick"]),c(p,{onClick:v=>L(e.uid)},{default:d(()=>[h("删除")]),_:2},1032,["onClick"])])]))),256))]),c(D,{"current-page":r.value,"total-count":i.value,"page-size":g(k),onChange:S},null,8,["current-page","total-count","page-size"])]))}});export{tt as default};
