import{a as N,p as z,c as D,e as L}from"./admin-d0afcbf5.js";import{_ as g}from"./NormalButton.vue_vue_type_script_setup_true_lang-77d36fc7.js";import{_ as $}from"./Pagination.vue_vue_type_script_setup_true_lang-540c9b31.js";import{d as B,u as S,j as V,r as h,o as y,c as m,k as e,l as n,e as _,F,b as M,a as i,g as f,p as C,w as p,h as w,R,q as T}from"./index-7fb9b2a6.js";import{N as v}from"./nprogress-131c7954.js";const j=e("p",{class:"mb-4 text-2xl font-bold"},"文章管理",-1),q={class:"w-full table-fixed text-center"},A=e("colgroup",null,[e("col",{width:"10"}),e("col",{width:"700"}),e("col",{width:"200"}),e("col",{width:"10%"}),e("col",{width:"10%"}),e("col",{width:"10%"}),e("col",{width:"10%"}),e("col",{width:"30%"})],-1),E=e("tr",null,[e("th",null,"PID"),e("th",null,"标题"),e("th",null,"发布者"),e("th",null,"点赞数"),e("th",null,"评论数"),e("th",null,"浏览量"),e("th",null,"允许评论"),e("th",null,"操作")],-1),I={class:"whitespace-nowrap"},G={class:"whitespace-nowrap"},W=B({__name:"post-manage",setup(H){const c=S(),a=V(),d=h([]),u=h(1),r=h(0);y(()=>{o()});function o(){v.start(),d.value=[],N(c.token,u.value).then(l=>{d.value=l.posts,r.value=l.count}).catch(l=>{a.error(l.message)}).finally(()=>{v.done()})}function k(l,s){s===1?z(c.token,l).then(t=>{a.success("禁止评论成功："),o()}).catch(t=>{a.error("禁止评论失败："+t.message)}):D(c.token,l).then(t=>{a.success("允许评论成功"),o()}).catch(t=>{a.error("允许评论失败："+t.message)})}function P(l){L(c.token,l).then(s=>{a.success("删除文章成功："),o()}).catch(s=>{a.error("删除文章失败："+s.message)})}function x(l){u.value=l,o()}return(l,s)=>(f(),m("div",null,[j,e("p",null,"文章总数："+n(r.value),1),e("p",null,"当前页："+n(u.value)+" , 总页数："+n(Math.ceil(r.value/_(C))),1),e("table",q,[A,E,(f(!0),m(F,null,M(d.value,t=>(f(),m("tr",null,[e("td",null,[i(_(R),{to:"/post/"+t.pid},{default:p(()=>[w(n(t.pid),1)]),_:2},1032,["to"])]),e("td",I,n(t.title),1),e("td",G,n(t.user.nickname+"("+t.user.uid+")"),1),e("td",null,n(t.like),1),e("td",null,n(t._count.comments),1),e("td",null,n(t.viewCount),1),e("td",{class:T(t.allowComment?"":"text-red-500")},n(t.allowComment?"是":"否"),3),e("td",null,[i(g,{onClick:b=>k(t.pid,t.allowComment)},{default:p(()=>[w(n(t.allowComment?"禁止评论":"允许评论"),1)]),_:2},1032,["onClick"]),i(g,{onClick:b=>P(t.pid)},{default:p(()=>[w("删除")]),_:2},1032,["onClick"])])]))),256))]),i($,{"current-page":u.value,"total-count":r.value,"page-size":_(C),onChange:x},null,8,["current-page","total-count","page-size"])]))}});export{W as default};
