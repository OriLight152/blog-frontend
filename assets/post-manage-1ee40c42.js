import{c as N,p as D,e as L,f as $}from"./admin-8241ca3f.js";import{_ as g}from"./NormalButton.vue_vue_type_script_setup_true_lang-9f1676ca.js";import{_ as B}from"./Pagination.vue_vue_type_script_setup_true_lang-b35ca8de.js";import{d as S,u as V,q as y,r as f,o as F,c as p,l as e,s as n,g as d,F as M,m as R,e as c,i as w,p as C,w as m,j as h,R as v,z as T}from"./index-0161809b.js";import{N as k}from"./nprogress-a817ebd9.js";import"./_commonjsHelpers-28e086c5.js";const j=e("p",{class:"mb-4 text-2xl font-bold"},"文章管理",-1),q={class:"w-full table-fixed text-center"},A=e("colgroup",null,[e("col",{width:"10"}),e("col",{width:"700"}),e("col",{width:"200"}),e("col",{width:"10%"}),e("col",{width:"10%"}),e("col",{width:"10%"}),e("col",{width:"10%"}),e("col",{width:"30%"})],-1),E=e("tr",null,[e("th",null,"PID"),e("th",null,"标题"),e("th",null,"发布者"),e("th",null,"点赞数"),e("th",null,"评论数"),e("th",null,"浏览量"),e("th",null,"允许评论"),e("th",null,"操作")],-1),I={class:"whitespace-nowrap"},G={class:"whitespace-nowrap"},X=S({__name:"post-manage",setup(H){const u=V(),o=y(),_=f([]),r=f(1),i=f(0);F(()=>{a()});function a(){k.start(),_.value=[],N(u.token,r.value).then(l=>{_.value=l.posts,i.value=l.count}).catch(l=>{o.error(l.message)}).finally(()=>{k.done()})}function P(l,s){s===1?D(u.token,l).then(t=>{o.success("禁止评论成功："),a()}).catch(t=>{o.error("禁止评论失败："+t.message)}):L(u.token,l).then(t=>{o.success("允许评论成功"),a()}).catch(t=>{o.error("允许评论失败："+t.message)})}function x(l){$(u.token,l).then(s=>{o.success("删除文章成功："),a()}).catch(s=>{o.error("删除文章失败："+s.message)})}function b(l){r.value=l,a()}return(l,s)=>(w(),p("div",null,[j,e("p",null,"文章总数："+n(i.value),1),e("p",null,"当前页："+n(r.value)+" , 总页数："+n(Math.ceil(i.value/d(C))),1),e("table",q,[A,E,(w(!0),p(M,null,R(_.value,t=>(w(),p("tr",null,[e("td",null,[c(d(v),{to:"/post/"+t.pid},{default:m(()=>[h(n(t.pid),1)]),_:2},1032,["to"])]),e("td",I,[c(d(v),{to:"/post/"+t.pid},{default:m(()=>[h(n(t.title),1)]),_:2},1032,["to"])]),e("td",G,n(t.user.nickname+"("+t.user.uid+")"),1),e("td",null,n(t.like),1),e("td",null,n(t._count.comments),1),e("td",null,n(t.viewCount),1),e("td",{class:T(t.allowComment?"":"text-red-500")},n(t.allowComment?"是":"否"),3),e("td",null,[c(g,{onClick:z=>P(t.pid,t.allowComment)},{default:m(()=>[h(n(t.allowComment?"禁止评论":"允许评论"),1)]),_:2},1032,["onClick"]),c(g,{onClick:z=>x(t.pid)},{default:m(()=>[h("删除")]),_:2},1032,["onClick"])])]))),256))]),c(B,{"current-page":r.value,"total-count":i.value,"page-size":d(C),onChange:b},null,8,["current-page","total-count","page-size"])]))}});export{X as default};
