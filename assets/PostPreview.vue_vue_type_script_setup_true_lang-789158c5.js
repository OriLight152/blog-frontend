import{f as v}from"./index-74aade08.js";import{I as k,a as x}from"./IconComment-df0eb70e.js";import{I as g}from"./IconLikeS-da43bb59.js";import{d as D,u as w,n as S,t as y,r as _,g as b,h as m,c as C,k as t,e as n,w as r,q as l,f as O,m as p}from"./index-9547b325.js";import{I as P}from"./IconView-1cdbe1ca.js";import{s as T,c as I}from"./post-b0a92490.js";const L={class:"w-full bg-white my-2 rounded-md overflow-hidden shadow-sm"},B={class:"flex pt-6 px-4"},R=["src"],V={class:"flex flex-col"},j={class:"mt-2 text-lg font-bold"},q={class:"text-gray-500 flex items-center text-sm"},N={class:"lg:ml-[80px] lg:pl-4 px-8"},A={class:"text-2xl leading-[60px]"},E={class:""},z={class:"flex h-10 mt-4"},F={class:"h-full flex items-center justify-center hover:bg-gray-500/10 transition-colors"},W=D({__name:"PostPreview",props:{postData:null},setup(e){const o=e,u=w(),d=S(),{login:f,likeCache:i}=y(u),s=_(!1);f.value&&(s.value=i.value.POST.includes(o.postData.pid.toString()));function h(){if(!f.value){d.warning("请先登录");return}s.value?I(u.token,"POST",o.postData.pid).then(a=>{s.value=!s.value,o.postData.like-=1}).catch(a=>{d("取消点赞失败："+a.message)}).finally(()=>{let a=i.value.POST.indexOf(o.postData.pid.toString());a!==-1&&i.value.POST.splice(a,1)}):T(u.token,"POST",o.postData.pid).then(a=>{s.value=!s.value,o.postData.like+=1}).catch(a=>{s.value=!s.value,d("点赞失败："+a.message)}).finally(()=>{i.value.POST.push(o.postData.pid.toString())})}return(a,G)=>{const c=b("RouterLink");return m(),C("div",L,[t("div",B,[n(c,{to:"/user/"+e.postData.user.uid},{default:r(()=>[t("img",{class:"rounded-full w-16 h-16 mr-4 hover:scale-[1.1] transition-transform",src:e.postData.user.avatar,alt:"avatar"},null,8,R)]),_:1},8,["to"]),t("div",V,[n(c,{to:"/user/"+e.postData.user.uid},{default:r(()=>[t("span",j,l(e.postData.user.nickname),1)]),_:1},8,["to"]),t("div",q,[t("span",null,l(O(v)(e.postData.createdAt)),1),n(P,{class:"w-4 h-4 inline-block ml-2 mr-1"}),t("span",null,l(e.postData.viewCount),1)])])]),n(c,{to:"/post/"+e.postData.pid},{default:r(()=>[t("div",N,[t("p",A,l(e.postData.title),1),t("p",E,l(e.postData.text),1)])]),_:1},8,["to"]),t("div",z,[n(c,{class:"flex-1",to:{path:"/post/"+e.postData.pid,query:{navigate:"comments"}}},{default:r(()=>[t("div",F,[n(k,{class:"w-5 h-5 inline-block mr-1"}),t("span",null,l(e.postData._count.comments),1)])]),_:1},8,["to"]),t("button",{class:"flex-1 flex items-center justify-center hover:bg-gray-500/10 transition-colors",onClick:h},[s.value?(m(),p(g,{key:0,class:"w-5 h-5 inline-block mr-1 text-red-500"})):(m(),p(x,{key:1,class:"w-5 h-5 inline-block mr-1"})),t("span",null,l(e.postData.like),1)])])])}}});export{W as _};
