import{d as I,u as L,s as S,t as A,r as h,j as g,c as v,a as e,F as V,v as r,x as d,e as c,w as x,E as k,y as i,g as f,f as u,h as B,G as T,C as $,H as j,o as _}from"./index-32e3c838.js";import{N as w}from"./NormalButton-526d9a55.js";const F={class:"w-full"},z={class:"w-[400px] bg-white mt-4 mx-auto px-8 pt-2 pb-6 rounded-[10px] overflow-hidden shadow-sm"},D=e("h1",{class:"text-center"},"用户登录",-1),G={class:"border rounded-md mt-10"},H={class:"flex items-center pl-3 border-b"},Z=e("span",{class:"w-[50px]"},"用户名",-1),q={class:"flex items-center pl-3"},J=e("span",{class:"w-[50px]"},"密码",-1),K={class:"flex justify-center mt-10"},O=e("h1",{class:"text-center"},"用户注册",-1),Q={class:"border rounded-md mt-10"},W={class:"flex items-center pl-3 border-b"},X=e("span",{class:"w-[50px]"},"用户名",-1),Y={class:"flex items-center pl-3 border-b"},ee=e("span",{class:"w-[50px]"},"昵称",-1),se={class:"flex items-center pl-3 border-b"},te=e("span",{class:"w-[50px]"},"邮箱",-1),ae={class:"flex items-center pl-3"},le=e("span",{class:"w-[50px]"},"密码",-1),ne={class:"pl-3 mt-2"},oe=e("span",null,"性别",-1),re={for:"sex_male",class:"ml-2"},ie={for:"sex_female",class:"ml-2"},de={for:"sex_secret",class:"ml-2"},ue={class:"flex justify-center mt-10"},pe={key:2},xe=I({__name:"Login",setup(me){const m=L(),l=S(),{devMode:E}=A(m),C=/^[a-z0-9-_]{5,15}$/,P=/^(?=.*?[a-zA-Z])(?=.*?[0-9]).{8,}$/,M=/[^@ \t\r\n]+@[^@ \t\r\n]+\.[^@ \t\r\n]+/,p=h(!1),o=h({username:"",password:""}),s=h({username:"",nickname:"",password:"",email:"",sex:"MALE"}),y=g(()=>C.test(s.value.username)||s.value.username==""),b=g(()=>P.test(s.value.password)||s.value.password==""),U=g(()=>M.test(s.value.email));async function N(){if(o.value.username.trim()===""){l.warning("用户名不可为空");return}if(o.value.password.trim()===""){l.warning("密码不可为空");return}T(o.value.username.trim(),o.value.password.trim()).then(n=>{l.success("登录成功"),m.login=!0,m.uid=n.id,m.token=n.token,localStorage.setItem("uid",n.id),localStorage.setItem("token",n.token),$.push("/profile")}).catch(n=>{l.error("登录失败："+n)})}async function R(){if(s.value.username.trim()===""){l.warning("用户名不可为空");return}if(s.value.nickname.trim()===""){l.warning("昵称不可为空");return}if(s.value.email.trim()===""){l.warning("邮箱不可为空");return}if(s.value.password.trim()===""){l.warning("密码不可为空");return}if(!y.value){l.warning("用户名格式错误");return}if(!U.value){l.warning("邮箱格式错误");return}if(!b.value){l.warning("密码格式错误");return}j(s.value.username.trim(),s.value.nickname.trim(),s.value.password.trim(),s.value.email.trim(),s.value.sex).then(n=>{l.success("注册成功"),p.value=!1}).catch(n=>{l.error("注册失败："+n)})}return(n,t)=>(_(),v("div",F,[e("div",z,[p.value?(_(),v(V,{key:1},[O,e("div",Q,[e("div",W,[X,r(e("input",{class:"flex-1 h-[40px] px-3 outline-none",type:"text",placeholder:"请输入用户名","onUpdate:modelValue":t[3]||(t[3]=a=>s.value.username=a)},null,512),[[d,s.value.username]])]),e("div",Y,[ee,r(e("input",{class:"flex-1 h-[40px] px-3 outline-none",type:"text",placeholder:"请输入昵称","onUpdate:modelValue":t[4]||(t[4]=a=>s.value.nickname=a)},null,512),[[d,s.value.nickname]])]),e("div",se,[te,r(e("input",{class:"flex-1 h-[40px] px-3 outline-none",type:"email",placeholder:"请输入邮箱","onUpdate:modelValue":t[5]||(t[5]=a=>s.value.email=a)},null,512),[[d,s.value.email]])]),e("div",ae,[le,r(e("input",{class:"flex-1 h-[40px] px-3 outline-none",type:"password",placeholder:"请输入密码","onUpdate:modelValue":t[6]||(t[6]=a=>s.value.password=a)},null,512),[[d,s.value.password]])])]),e("div",ne,[oe,e("label",re,[r(e("input",{type:"radio",name:"sex",id:"sex_male",value:"MALE","onUpdate:modelValue":t[7]||(t[7]=a=>s.value.sex=a)},null,512),[[k,s.value.sex]]),i(" 男")]),e("label",ie,[r(e("input",{type:"radio",name:"sex",id:"sex_female",value:"FEMALE","onUpdate:modelValue":t[8]||(t[8]=a=>s.value.sex=a)},null,512),[[k,s.value.sex]]),i(" 女")]),e("label",de,[r(e("input",{type:"radio",name:"sex",id:"sex_secret",value:"SECRET","onUpdate:modelValue":t[9]||(t[9]=a=>s.value.sex=a)},null,512),[[k,s.value.sex]]),i(" 保密")])]),e("div",ue,[c(w,{class:"mr-2",onClick:t[10]||(t[10]=a=>p.value=!1)},{default:x(()=>[i("返回登录")]),_:1}),c(w,{onClick:R},{default:x(()=>[i("注册")]),_:1})])],64)):(_(),v(V,{key:0},[D,e("div",G,[e("div",H,[Z,r(e("input",{class:"flex-1 h-[40px] px-3 outline-none",type:"text",placeholder:"请输入用户名","onUpdate:modelValue":t[0]||(t[0]=a=>o.value.username=a)},null,512),[[d,o.value.username]])]),e("div",q,[J,r(e("input",{class:"flex-1 h-[40px] px-3 outline-none",type:"password",placeholder:"请输入密码","onUpdate:modelValue":t[1]||(t[1]=a=>o.value.password=a)},null,512),[[d,o.value.password]])])]),e("div",K,[c(w,{class:"mr-2",onClick:t[2]||(t[2]=a=>p.value=!0)},{default:x(()=>[i("前往注册")]),_:1}),c(w,{onClick:N},{default:x(()=>[i("登录")]),_:1})])],64)),f(E)?(_(),v("div",pe,[e("div",null,"isRegister "+u(p.value),1),e("div",null,"loginParams "+u(o.value),1),e("div",null,"registerParams "+u(s.value),1),e("div",null,"vaildUserId "+u(f(y)),1),e("div",null,"vaildEmail "+u(f(U)),1),e("div",null,"vaildUserPwd "+u(f(b)),1)])):B("",!0)])]))}});export{xe as default};
