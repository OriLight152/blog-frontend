import{h as y,i as z,j as P,k as S}from"./admin-439492b5.js";import{_ as C}from"./NormalButton.vue_vue_type_script_setup_true_lang-632bc283.js";import{_ as T}from"./Pagination.vue_vue_type_script_setup_true_lang-7e00d940.js";import{d as $,u as B,n as I,r as p,o as M,c as _,k as t,q as a,f,F as V,l as E,e as d,h as m,p as k,w as g,i as w,y as F,g as R}from"./index-9547b325.js";import{N as v}from"./nprogress-a817ebd9.js";import{f as j}from"./index-74aade08.js";import"./_commonjsHelpers-28e086c5.js";const q=t("p",{class:"mb-4 text-2xl font-bold"},"评论管理",-1),A={class:"w-full table-fixed text-center"},G=t("colgroup",null,[t("col",{width:"10"}),t("col",{width:"700"}),t("col",{width:"100"}),t("col",{width:"100"}),t("col",{width:"20%"}),t("col",{width:"10%"}),t("col",{width:"10%"}),t("col",{width:"10%"}),t("col",{width:"30%"})],-1),H=t("tr",null,[t("th",null,"CID"),t("th",null,"内容"),t("th",null,"发布者"),t("th",null,"所在文章"),t("th",null,"IP"),t("th",null,"回复ID"),t("th",null,"状态"),t("th",null,"评论时间"),t("th",null,"操作")],-1),J={class:"whitespace-nowrap"},K={class:"whitespace-nowrap"},O={class:"whitespace-nowrap"},Q={class:"whitespace-nowrap"},at=$({__name:"comment-manage",setup(U){const c=B(),o=I(),h=p([]),u=p(1),i=p(0),x={0:"正常",2:"违规"};M(()=>{l()});function l(){v.start(),h.value=[],y(c.token,u.value).then(s=>{h.value=s.comments,i.value=s.count}).catch(s=>{o.error(s.message)}).finally(()=>{v.done()})}function b(s,r){r===0?z(c.token,s).then(n=>{o.success("标记评论成功"),l()}).catch(n=>{o.error("标记评论失败："+n.message)}):P(c.token,s).then(n=>{o.success("标记评论成功"),l()}).catch(n=>{o.error("标记评论失败："+n.message)})}function D(s){S(c.token,s).then(r=>{o.success("删除评论成功"),l()}).catch(r=>{o.error("解禁评论失败："+r.message)})}function L(s){u.value=s,l()}return(s,r)=>{const n=R("RouterLink");return m(),_("div",null,[q,t("p",null,"评论总数："+a(i.value),1),t("p",null,"当前页："+a(u.value)+" , 总页数："+a(Math.ceil(i.value/f(k))),1),t("table",A,[G,H,(m(!0),_(V,null,E(h.value,e=>(m(),_("tr",null,[t("td",null,a(e.cid),1),t("td",J,a(e.text),1),t("td",K,a(e.user.nickname+"("+e.user.uid+")"),1),t("td",O,[d(n,{to:"/post/"+e.post.pid},{default:g(()=>[w(a(e.post.title+"("+e.post.pid+")"),1)]),_:2},1032,["to"])]),t("td",null,a(e.ip),1),t("td",null,a(e.replyTo),1),t("td",{class:F(e.status===2?"text-red-500":"")},a(x[e.status]),3),t("td",Q,a(f(j)(e.createdAt)),1),t("td",null,[d(C,{onClick:N=>b(e.cid,e.status)},{default:g(()=>[w(a(e.status===0?"标记为违规":"标记为正常"),1)]),_:2},1032,["onClick"]),d(C,{onClick:N=>D(e.cid)},{default:g(()=>[w("删除")]),_:2},1032,["onClick"])])]))),256))]),d(T,{"current-page":u.value,"total-count":i.value,"page-size":f(k),onChange:L},null,8,["current-page","total-count","page-size"])])}}});export{at as default};
