import{a as z,b as N,u as $,d as B}from"./admin-d202eeaa.js";import{_}from"./NormalButton.vue_vue_type_script_setup_true_lang-ff313dcd.js";import{_ as D}from"./Pagination.vue_vue_type_script_setup_true_lang-3b42b998.js";import{d as M,u as A,q as F,r as m,o as P,c as f,l as t,s as a,g as w,F as R,m as T,e as c,i as g,p as k,w as d,j as h,R as V,z as y}from"./index-8e533435.js";import{N as C}from"./nprogress-a817ebd9.js";import"./_commonjsHelpers-28e086c5.js";const j=t("p",{class:"mb-4 text-2xl font-bold"},"用户管理",-1),q={class:"w-full table-fixed text-center"},I=t("colgroup",null,[t("col",{width:"10"}),t("col",{width:"10%"}),t("col",{width:"700"}),t("col",{width:"10%"}),t("col",{width:"10%"}),t("col",{width:"10%"}),t("col",{width:"10%"}),t("col",{width:"10%"}),t("col",{width:"30%"})],-1),G=t("tr",null,[t("th",null,"UID"),t("th",null,"用户名"),t("th",null,"昵称"),t("th",null,"邮箱"),t("th",null,"性别"),t("th",null,"用户组"),t("th",null,"状态"),t("th",null,"头像"),t("th",null,"操作")],-1),H={class:"whitespace-nowrap"},J={class:"whitespace-nowrap"},K={class:"whitespace-nowrap overflow-ellipsis"},et=M({__name:"user-manage",setup(O){const u=A(),n=F(),p=m([]),r=m(1),i=m(0),x={0:"正常",2:"封禁"},E={MALE:"男",FEMALE:"男",SECRET:"保密"};P(()=>{l()});function l(){C.start(),p.value=[],z(u.token,r.value).then(s=>{p.value=s.users,i.value=s.count}).catch(s=>{n.error(s.message)}).finally(()=>{C.done()})}function b(s){window.open(s)}function U(s,o){o===0?N(u.token,s).then(e=>{n.success("封禁用户成功"),l()}).catch(e=>{n.error("封禁用户失败"+e.message)}):$(u.token,s).then(e=>{n.success("解禁用户成功"),l()}).catch(e=>{n.error("解禁用户失败："+e.message)})}function L(s){B(u.token,s).then(o=>{n.success("删除用户成功："),l()}).catch(o=>{n.error("删除用户失败："+o.message)})}function S(s){r.value=s,l()}return(s,o)=>(g(),f("div",null,[j,t("p",null,"用户总数："+a(i.value),1),t("p",null,"当前页："+a(r.value)+" , 总页数："+a(Math.ceil(i.value/w(k))),1),t("table",q,[I,G,(g(!0),f(R,null,T(p.value,e=>(g(),f("tr",null,[t("td",null,[c(w(V),{to:"/user/"+e.uid},{default:d(()=>[h(a(e.uid),1)]),_:2},1032,["to"])]),t("td",H,a(e.name),1),t("td",J,a(e.nickname),1),t("td",null,a(e.email),1),t("td",null,a(E[e.sex]),1),t("td",null,a(e.role),1),t("td",{class:y(e.status===2?"text-red-500":"")},a(x[e.status]),3),t("td",K,[c(_,{onClick:v=>b(e.avatar)},{default:d(()=>[h("查看图片")]),_:2},1032,["onClick"])]),t("td",null,[c(_,{onClick:v=>U(e.uid,e.status)},{default:d(()=>[h(a(e.status===0?"封禁":"解禁"),1)]),_:2},1032,["onClick"]),c(_,{onClick:v=>L(e.uid)},{default:d(()=>[h("删除")]),_:2},1032,["onClick"])])]))),256))]),c(D,{"current-page":r.value,"total-count":i.value,"page-size":w(k),onChange:S},null,8,["current-page","total-count","page-size"])]))}});export{et as default};
